
services:
  qbittorrent:
    image: lscr.io/linuxserver/qbittorrent:latest
    container_name: qbittorrent
    network_mode: "service:gluetun"
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
      - WEBUI_PORT=${QBITTORRENT_WEB_PORT}
    volumes:
      - ${CONFIG_ROOT}/qbittorrent:/config
      - ${QBIT_DOWNLOADS_DIR}:/downloads
      - ${TORRENT_FILE_LOCATION}:/torrents
    depends_on:
      gluetun:
        condition: service_healthy
    healthcheck:
      test: [ "CMD", "curl", "-fsS", "http://127.0.0.1:${QBITTORRENT_WEB_PORT}/" ]
      interval: 30s
      timeout: 5s
      retries: 5
    restart: unless-stopped

  qbit-force-seed:
    build: ../projects/qbit-force-seed
    container_name: qbit-force-seed
    network_mode: host
    environment:
      # qBittorrent Web UI/API
      - QBIT_URL=http://127.0.0.1:${QBITTORRENT_WEB_PORT}
      - QBIT_USER=${QBITTORRENT_USER}
      - QBIT_PASS=${QBITTORRENT_PASS}

      # Behaviour
      - FORCE_DAYS=15
      - POLL_SECONDS=900
      - CATEGORIES=tv,movies

      # Optional: restrict to TorrentLeech torrents only (recommended if you also have other trackers)
      # Put a substring that appears in the tracker URL:
      # - TRACKER_MATCH=torrentleech
    depends_on:
      qbittorrent:
        condition: service_healthy
    restart: unless-stopped


  sonarr:
    image: lscr.io/linuxserver/sonarr:latest
    container_name: sonarr
    network_mode: "service:gluetun"
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${CONFIG_ROOT}/sonarr:/config
      - ${TV_DIR}:/tv
      - ${QBIT_DOWNLOADS_DIR}:/downloads
      - ${TV_UK_DIR}:/tv-uk
    depends_on:
      gluetun:
        condition: service_healthy
    restart: unless-stopped

  radarr:
    image: lscr.io/linuxserver/radarr:latest
    container_name: radarr
    network_mode: "service:gluetun"
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${CONFIG_ROOT}/radarr:/config
      - ${MOVIES_DIR}:/movies
      - ${QBIT_DOWNLOADS_DIR}:/downloads
    depends_on:
      gluetun:
        condition: service_healthy
    restart: unless-stopped

  prowlarr:
    image: lscr.io/linuxserver/prowlarr:latest
    container_name: prowlarr
    network_mode: "service:gluetun"
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${CONFIG_ROOT}/prowlarr:/config
    depends_on:
      gluetun:
        condition: service_healthy
    restart: unless-stopped

  recyclarr:
    image: ghcr.io/recyclarr/recyclarr
    container_name: recyclarr
    user: ${PUID}:${PGID}
    network_mode: "service:gluetun"
    environment:
      - TZ=${TZ}
      - SONARR_URL=http://localhost:${SONARR_PORT}
      - SONARR_API_KEY=${SONARR_API_KEY}
      - RADARR_URL=http://localhost:${RADARR_PORT}
      - RADARR_API_KEY=${RADARR_API_KEY}
    volumes:
      - ${CONFIG_ROOT}/recyclarr:/config
    depends_on:
      gluetun:
        condition: service_healthy
    restart: unless-stopped

  bazarr:
    image: lscr.io/linuxserver/bazarr:latest
    container_name: bazarr
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    network_mode: "service:gluetun"
    volumes:
      - ${CONFIG_ROOT}/bazarr:/config
      - ${TV_DIR}:/tv
      - ${MOVIES_DIR}:/movies
      - ${TV_UK_DIR}:/tv-uk
    depends_on:
      gluetun:
        condition: service_healthy
    restart: unless-stopped

#  readarr:
#    image: lscr.io/linuxserver/readarr:develop
#    container_name: readarr
#    network_mode: "service:gluetun"
#    environment:
#      - PUID=${PUID}
#      - PGID=${PGID}
#      - TZ=${TZ}
#    volumes:
#      - ${CONFIG_ROOT}/readarr:/config
#      - ${BOOKS_DIR}:/books
#      - ${AUDIOBOOKS_DIR}:/audiobooks
#      - ${DOWNLOADS_DIR}:/downloads
#    depends_on:
#      gluetun:
#        condition: service_healthy
#    restart: unless-stopped
